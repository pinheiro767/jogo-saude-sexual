<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conexão Corpo: Saúde Reprodutiva, Sexualidade e Saúde Íntima</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 10% { transform: translateX(-5px); } 20% { transform: translateX(5px); } 30% { transform: translateX(-5px); } 40% { transform: translateX(5px); } 50% { transform: translateX(0); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .pulse { animation: pulse 2s infinite; }
        .shake { animation: shake 0.5s ease-in-out; }
        .fade-in { animation: fadeIn 0.5s ease; }
        .gradient-bg { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); }
        .neon-glow { box-shadow: 0 0 15px rgba(59, 130, 246, 0.4), 0 0 30px rgba(255, 107, 107, 0.3); }
        .locked { filter: grayscale(80%) brightness(0.5); pointer-events: none; cursor: not-allowed; }
        #video-container { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background-color: #000; z-index: 9999; display: flex; justify-content: center; align-items: center; transition: opacity 0.5s ease-out; }
        #video-container video { width: 100%; height: 100%; object-fit: cover; }
        #play-video { position: absolute; z-index: 10001; font-size: 80px; color: white; background: rgba(0, 0, 0, 0.4); border: 3px solid white; border-radius: 50%; width: 120px; height: 120px; line-height: 120px; text-align: center; cursor: pointer; transition: all 0.3s; }
        #play-video:hover { background: rgba(255, 107, 107, 0.5); transform: scale(1.1); }
        #skip-video { position: absolute; bottom: 30px; right: 30px; padding: 12px 25px; font-size: 16px; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); color: white; border: 2px solid rgba(255, 255, 255, 0.5); border-radius: 10px; cursor: pointer; z-index: 10000; transition: all 0.3s; }
        #skip-video:hover { background: rgba(255, 255, 255, 0.4); border-color: white; }
        #video-container.hidden { opacity: 0; pointer-events: none; }
        .answer-btn { white-space: normal; text-align: left; line-height: 1.4; padding-top: 0.75rem; padding-bottom: 0.75rem; }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">

    <div id="video-container">
        <video id="intro-video" playsinline>
            <source src="video/1000007047.mp4" type="video/mp4"> Seu navegador não suporta o vídeo.
        </video>
        <button id="play-video">▶</button>
        <button id="skip-video" style="display: none;">Pular Vídeo ⏩</button>
    </div>

    <div class="bg-black bg-opacity-50 p-4 border-b border-pink-500">
         <div class="max-w-6xl mx-auto flex flex-wrap justify-between items-center gap-y-2">
            <div>
                <h1 class="text-xl md:text-2xl font-bold text-pink-400">💖 Conexão Corpo: Saúde Reprodutiva, Sexualidade e Saúde Íntima</h1>
                <p class="text-xs md:text-sm text-gray-300">Resolva os desafios para entender seu corpo!</p>
            </div>
            <div class="flex items-center space-x-4 md:space-x-6">
                <div class="text-center"><div class="text-yellow-400 font-bold text-lg md:text-xl" id="timer">10:00</div><div class="text-xs text-gray-400">TEMPO</div></div>
                <div class="text-center"><div class="text-green-400 font-bold text-lg md:text-xl" id="score">0</div><div class="text-xs text-gray-400">PONTOS</div></div>
                <div class="text-center"><div class="text-blue-400 font-bold text-lg md:text-xl" id="progress">0/5</div><div class="text-xs text-gray-400">SALAS</div></div>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto p-4 md:p-6">
        <div id="intro-screen" class="text-center py-8 md:py-12 hidden">
            <div class="bg-black bg-opacity-70 rounded-3xl p-6 md:p-8 border border-pink-500 neon-glow">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-pink-400">🌸 JORNADA DO AUTOCONHECIMENTO</h2>
                <p class="text-lg md:text-xl mb-6 text-gray-300">Seu corpo tem segredos! Para desvendá-los, você precisa resolver 5 desafios sobre saúde íntima e sexualidade.</p>
                <p class="text-md md:text-lg mb-8 text-yellow-400">⏰ Você tem 10 minutos para completar a jornada!</p>
                <button onclick="startGame()" class="bg-pink-600 hover:bg-pink-700 px-6 py-3 md:px-8 md:py-4 rounded-xl text-lg md:text-xl font-bold transition-all transform hover:scale-105 neon-glow">
                    🔓 COMEÇAR JORNADA
                </button>
            </div>
        </div>

        <div id="game-board" class="hidden">
             <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
                <div id="room-1" class="room-card bg-gradient-to-br from-blue-900 to-blue-700 border-2 border-blue-500 rounded-2xl p-4 cursor-pointer transform transition-all hover:scale-105" onclick="enterRoom(1)"> <div class="text-center"><div class="text-3xl mb-2">💧🩸</div><h3 class="text-lg font-bold mb-1">Fluidos e Ciclos</h3><p class="text-xs text-blue-200">Lubrificantes e Menstruação</p><div class="mt-3 flex justify-center"><span id="status-1" class="bg-gray-600 px-3 py-1 rounded-full text-xs">🔒</span></div></div> </div>
                <div id="room-2" class="room-card locked bg-gradient-to-br from-red-900 to-red-700 border-2 border-red-500 rounded-2xl p-4 cursor-pointer transform transition-all hover:scale-105" onclick="enterRoom(2)"> <div class="text-center"><div class="text-3xl mb-2">🦠⚠️</div><h3 class="text-lg font-bold mb-1">Proteção Essencial</h3><p class="text-xs text-red-200">Riscos e Mitos sobre ISTs</p><div class="mt-3 flex justify-center"><span id="status-2" class="bg-gray-600 px-3 py-1 rounded-full text-xs">🔒</span></div></div> </div>
                <div id="room-3" class="room-card locked bg-gradient-to-br from-purple-900 to-purple-700 border-2 border-purple-500 rounded-2xl p-4 cursor-pointer transform transition-all hover:scale-105" onclick="enterRoom(3)"> <div class="text-center"><div class="text-3xl mb-2">🧼✨</div><h3 class="text-lg font-bold mb-1">Cuidados Diários</h3><p class="text-xs text-purple-200">Higiene e Descarte</p><div class="mt-3 flex justify-center"><span id="status-3" class="bg-gray-600 px-3 py-1 rounded-full text-xs">🔒</span></div></div> </div>
                <div id="room-4" class="room-card locked bg-gradient-to-br from-teal-900 to-teal-700 border-2 border-teal-500 rounded-2xl p-4 cursor-pointer transform transition-all hover:scale-105" onclick="enterRoom(4)"> <div class="text-center"><div class="text-3xl mb-2">🤝💬</div><h3 class="text-lg font-bold mb-1">Relações e Respeito</h3><p class="text-xs text-teal-200">Comunicação e Consentimento</p><div class="mt-3 flex justify-center"><span id="status-4" class="bg-gray-600 px-3 py-1 rounded-full text-xs">🔒</span></div></div> </div>
                <div id="room-5" class="room-card locked bg-gradient-to-br from-yellow-900 to-yellow-700 border-2 border-yellow-500 rounded-2xl p-4 cursor-pointer transform transition-all hover:scale-105" onclick="enterRoom(5)"> <div class="text-center"><div class="text-3xl mb-2">🛡️❗</div><h3 class="text-lg font-bold mb-1">Prevenção e Ação</h3><p class="text-xs text-yellow-200">Preservativos e Contracepção</p><div class="mt-3 flex justify-center"><span id="status-5" class="bg-gray-600 px-3 py-1 rounded-full text-xs">🔒</span></div></div> </div>
            </div>

            <div id="case-area" class="bg-black bg-opacity-50 rounded-2xl p-6 md:p-8 border border-gray-600 min-h-[400px] flex items-center justify-center">
                 <div id="waiting-message" class="text-center py-12"> <div class="text-6xl mb-4 pulse">🌸</div> <h3 class="text-2xl font-bold text-gray-400 mb-2">Escolha uma sala desbloqueada</h3> <p class="text-gray-500">Clique para iniciar o desafio!</p> </div>
                <div id="case-1" class="case-content hidden w-full"> <div class="bg-blue-900 bg-opacity-50 rounded-xl p-4 md:p-6 border border-blue-500 mb-6"><h2 class="text-xl md:text-2xl font-bold text-blue-400 mb-4">💧🩸 SALA 1: Fluidos e Ciclos</h2></div> <div class="space-y-4"> <div class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600"><h4 class="text-md md:text-lg font-bold text-blue-300 mb-3">🧩 PUZZLE 1/3: Lubrificantes à base de óleo são seguros para usar com preservativos de látex?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'b', this)">Falso</button></div></div> <div id="puzzle-2-case-1" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-blue-300 mb-3">🧩 PUZZLE 2/3: É possível engravidar tendo relação sexual durante a menstruação?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'b', this)">Falso</button></div></div> <div id="puzzle-3-case-1" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-blue-300 mb-3">🧩 PUZZLE 3/3: Qual a diferença entre libido e desejo sexual?</h4><div class="grid grid-cols-1 gap-3"><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'a', this)">Libido é a vontade específica, desejo é o impulso geral.</button><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'b', this)">Libido é o impulso/energia sexual geral, desejo é a vontade específica de ter atividade.</button><button class="answer-btn bg-gray-700 hover:bg-blue-600 p-3 rounded-lg transition-all" onclick="checkAnswer(1, 'c', this)">Não há diferença, são sinônimos.</button></div></div> <div id="success-1" class="hidden success-message"><div class="text-4xl mb-3">✅</div><h3 class="text-xl font-bold text-green-400 mb-2">SALA 1 CONCLUÍDA!</h3><button onclick="completeCase(1)" class="next-button">🔓 Próxima Sala</button></div> </div> </div>
                 <div id="case-2" class="case-content hidden w-full"> <div class="bg-red-900 bg-opacity-50 rounded-xl p-4 md:p-6 border border-red-500 mb-6"><h2 class="text-xl md:text-2xl font-bold text-red-400 mb-4">🦠⚠️ SALA 2: Proteção Essencial</h2></div> <div class="space-y-4"> <div class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600"><h4 class="text-md md:text-lg font-bold text-red-300 mb-3">🧩 PUZZLE 1/3: IST é um problema apenas para pessoas com múltiplos parceiros?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'b', this)">Falso</button></div></div> <div id="puzzle-2-case-2" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-red-300 mb-3">🧩 PUZZLE 2/3: O sexo anal é uma prática de baixo risco para a transmissão de IST?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'b', this)">Falso</button></div></div> <div id="puzzle-3-case-2" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-red-300 mb-3">🧩 PUZZLE 3/3: O que é 'sexting' e qual o principal risco se feito sem consentimento/segurança?</h4><div class="grid grid-cols-1 gap-3"><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'a', this)">É enviar mensagens de texto normais; o risco é gastar muito crédito.</button><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'b', this)">É enviar conteúdo sexual explícito; o risco é a distribuição não consensual (ilegal).</button><button class="answer-btn bg-gray-700 hover:bg-red-600 p-3 rounded-lg transition-all" onclick="checkAnswer(2, 'c', this)">É marcar encontros online; o risco é conhecer pessoas perigosas.</button></div></div> <div id="success-2" class="hidden success-message"><div class="text-4xl mb-3">✅</div><h3 class="text-xl font-bold text-green-400 mb-2">SALA 2 CONCLUÍDA!</h3><button onclick="completeCase(2)" class="next-button">🔓 Próxima Sala</button></div> </div> </div>
                 <div id="case-3" class="case-content hidden w-full"> <div class="bg-purple-900 bg-opacity-50 rounded-xl p-4 md:p-6 border border-purple-500 mb-6"><h2 class="text-xl md:text-2xl font-bold text-purple-400 mb-4">🧼✨ SALA 3: Cuidados Diários</h2></div> <div class="space-y-4"> <div class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600"><h4 class="text-md md:text-lg font-bold text-purple-300 mb-3">🧩 PUZZLE 1/3: Qual a ação correta para higiene íntima da Cris?</h4><div class="grid grid-cols-1 gap-3"><button class="answer-btn bg-gray-700 hover:bg-purple-600 p-3 rounded-lg transition-all" onclick="checkAnswer(3, 'a', this)">Usar sabonete perfumado na vulva e fazer ducha vaginal.</button><button class="answer-btn bg-gray-700 hover:bg-purple-600 p-3 rounded-lg transition-all" onclick="checkAnswer(3, 'b', this)">Lavar apenas a vulva (externa) com água/sabonete e evitar ducha.</button></div></div> <div id="puzzle-2-case-3" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-purple-300 mb-3">🧩 PUZZLE 2/3: Como a Cris deve descartar o absorvente usado?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-purple-600 p-3 rounded-lg transition-all" onclick="checkAnswer(3, 'a', this)">Jogar no vaso sanitário.</button><button class="answer-btn bg-gray-700 hover:bg-purple-600 p-3 rounded-lg transition-all" onclick="checkAnswer(3, 'b', this)">Enrolar e jogar no lixo.</button></div></div> <div id="puzzle-3-case-3" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-purple-300 mb-3">🧩 PUZZLE 3/3: Qual calcinha a Cris deve escolher para passar o dia fora, pensando na saúde?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-purple-600 p-3 rounded-lg transition-all" onclick="checkAnswer(3, 'a', this)">Sintética e apertada.</button><button class="answer-btn bg-gray-700 hover:bg-purple-600 p-3 rounded-lg transition-all" onclick="checkAnswer(3, 'b', this)">Algodão e confortável.</button></div></div> <div id="success-3" class="hidden success-message"><div class="text-4xl mb-3">✅</div><h3 class="text-xl font-bold text-green-400 mb-2">SALA 3 CONCLUÍDA!</h3><button onclick="completeCase(3)" class="next-button">🔓 Próxima Sala</button></div> </div> </div>
                 <div id="case-4" class="case-content hidden w-full"> <div class="bg-teal-900 bg-opacity-50 rounded-xl p-4 md:p-6 border border-teal-500 mb-6"><h2 class="text-xl md:text-2xl font-bold text-teal-400 mb-4">🤝💬 SALA 4: Relações e Respeito</h2></div> <div class="space-y-4"> <div class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600"><h4 class="text-md md:text-lg font-bold text-teal-300 mb-3">🧩 PUZZLE 1/3: Toda IST apresenta sintomas visíveis?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'b', this)">Falso</button></div></div> <div id="puzzle-2-case-4" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-teal-300 mb-3">🧩 PUZZLE 2/3: Qual a importância da comunicação e consentimento nas relações sexuais?</h4><div class="grid grid-cols-1 gap-3"><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'a', this)">São opcionais se o casal se conhece bem.</button><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'b', this)">São a base para garantir segurança, respeito e prazer mútuo.</button><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'c', this)">Apenas o consentimento inicial é necessário.</button></div></div> <div id="puzzle-3-case-4" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-teal-300 mb-3">🧩 PUZZLE 3/3: O que significa 'Zona de Conforto' na sexualidade?</h4><div class="grid grid-cols-1 gap-3"><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'a', this)">Evitar qualquer tipo de atividade sexual.</button><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'b', this)">As práticas e intimidades com as quais a pessoa se sente segura e à vontade.</button><button class="answer-btn bg-gray-700 hover:bg-teal-600 p-3 rounded-lg transition-all" onclick="checkAnswer(4, 'c', this)">Fazer apenas o que o parceiro gosta.</button></div></div> <div id="success-4" class="hidden success-message"><div class="text-4xl mb-3">✅</div><h3 class="text-xl font-bold text-green-400 mb-2">SALA 4 CONCLUÍDA!</h3><button onclick="completeCase(4)" class="next-button">🔓 Última Sala</button></div> </div> </div>
                 <div id="case-5" class="case-content hidden w-full"> <div class="bg-yellow-900 bg-opacity-50 rounded-xl p-4 md:p-6 border border-yellow-500 mb-6"><h2 class="text-xl md:text-2xl font-bold text-yellow-400 mb-4">🛡️❗ SALA 5: Prevenção e Ação</h2></div> <div class="space-y-4"> <div class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600"><h4 class="text-md md:text-lg font-bold text-yellow-300 mb-3">🧩 PUZZLE 1/2: É seguro usar dois preservativos ao mesmo tempo?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-yellow-600 p-3 rounded-lg transition-all" onclick="checkAnswer(5, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-yellow-600 p-3 rounded-lg transition-all" onclick="checkAnswer(5, 'b', this)">Falso</button></div></div> <div id="puzzle-2-case-5" class="question-block bg-gray-800 rounded-xl p-4 md:p-6 border border-gray-600 hidden"><h4 class="text-md md:text-lg font-bold text-yellow-300 mb-3">🧩 PUZZLE 2/2: A pílula do dia seguinte pode ser usada como método contraceptivo regular?</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><button class="answer-btn bg-gray-700 hover:bg-yellow-600 p-3 rounded-lg transition-all" onclick="checkAnswer(5, 'a', this)">Verdadeiro</button><button class="answer-btn bg-gray-700 hover:bg-yellow-600 p-3 rounded-lg transition-all" onclick="checkAnswer(5, 'b', this)">Falso</button></div></div> <div id="success-5" class="hidden success-message"><div class="text-4xl mb-3">✅</div><h3 class="text-xl font-bold text-green-400 mb-2">SALA 5 CONCLUÍDA!</h3><button onclick="completeCase(5)" class="finish-button">🏆 FINALIZAR JORNADA</button></div> </div> </div>
            </div> </div> <div id="victory-screen" class="hidden text-center py-12"> <div class="bg-gradient-to-br from-green-900 to-green-700 rounded-3xl p-8 border border-green-500 neon-glow"> <div class="text-6xl mb-4">🏆</div> <h2 class="text-4xl font-bold mb-4 text-green-400">JORNADA CONCLUÍDA!</h2> <p class="text-xl mb-6 text-green-300">Parabéns! Você desvendou os desafios e aprendeu mais sobre seu corpo!</p> <div class="bg-black bg-opacity-50 rounded-xl p-6 mb-6"> <div class="grid grid-cols-3 gap-6 text-center"> <div><div class="text-2xl font-bold text-yellow-400" id="final-time">--:--</div><div class="text-sm text-gray-400">Tempo Final</div></div> <div><div class="text-2xl font-bold text-green-400" id="final-score">0</div><div class="text-sm text-gray-400">Pontuação</div></div> <div><div class="text-2xl font-bold text-blue-400">5/5</div><div class="text-sm text-gray-400">Salas Concluídas</div></div> </div> </div> <button onclick="restartGame()" class="bg-blue-600 hover:bg-blue-700 px-8 py-4 rounded-xl text-xl font-bold transition-all transform hover:scale-105">🔄 JOGAR NOVAMENTE</button> </div> </div>
    </div>

    <audio id="som-fundo" src="audio/bgm.mp3" loop></audio>
    <audio id="som-click" src="audio/coin.wav"></audio>
    <audio id="som-correto" src="audio/win.wav"></audio>
    <audio id="som-incorreto" src="audio/error.mp3"></audio>
    <audio id="som-vitoria" src="audio/win.wav"></audio>
    <audio id="som-gameover" src="audio/error.mp3"></audio>

    <script>
        // --- BANCO DE PERGUNTAS (14 perguntas) ---
        const gameQuestions = [
            { options: {a: "Verdadeiro", b: "Falso"}, answer: 'b', feedback: "Lubrificantes à base de óleo (como vaselina) podem danificar o látex. Use sempre base água ou silicone." }, { options: {a: "Verdadeiro", b: "Falso"}, answer: 'a', feedback: "Sim, é possível embora menos provável. Espermatozoides sobrevivem dias." }, { options: {a: "Libido é a vontade específica, desejo é o impulso geral.", b: "Libido é o impulso/energia sexual geral, desejo é a vontade específica de ter atividade.", c: "Não há diferença, são sinônimos."}, answer: 'b', feedback: "Libido é o 'motor', desejo é a 'vontade de dirigir'." },
            { options: {a: "Verdadeiro", b: "Falso"}, answer: 'b', feedback: "Não. Qualquer pessoa sexualmente ativa pode contrair IST sem proteção." }, { options: {a: "Verdadeiro", b: "Falso"}, answer: 'b', feedback: "Não, é de alto risco devido à fragilidade do tecido anal." }, { options: {a: "É enviar mensagens de texto normais; o risco é gastar muito crédito.", b: "É enviar conteúdo sexual explícito; o risco é a distribuição não consensual (ilegal).", c: "É marcar encontros online; o risco é conhecer pessoas perigosas."}, answer: 'b', feedback: "Sexting envolve conteúdo explícito. A distribuição sem consentimento é crime." },
            { options: {a: "Usar sabonete perfumado na vulva e fazer ducha vaginal.", b: "Lavar apenas a vulva (externa) com água/sabonete e evitar ducha."}, answer: 'b', feedback: "A vagina é autolimpante. Duchas desequilibram o pH. Lave só externamente." }, { options: {a: "Jogar no vaso sanitário.", b: "Enrolar e jogar no lixo."}, answer: 'b', feedback: "Sempre no lixo para evitar entupimentos e poluição." }, { options: {a: "Sintética e apertada.", b: "Algodão e confortável."}, answer: 'b', feedback: "Algodão permite a respiração da pele, prevenindo infecções." },
            { options: {a: "Verdadeiro", b: "Falso"}, answer: 'b', feedback: "Não, muitas ISTs podem ser assintomáticas. Teste-se regularmente." }, { options: {a: "São opcionais se o casal se conhece bem.", b: "São a base para garantir segurança, respeito e prazer mútuo.", c: "Apenas o consentimento inicial é necessário."}, answer: 'b', feedback: "Consentimento deve ser contínuo, claro e entusiástico." }, { options: {a: "Evitar qualquer tipo de atividade sexual.", b: "As práticas e intimidades com as quais a pessoa se sente segura e à vontade.", c: "Fazer apenas o que o parceiro gosta."}, answer: 'b', feedback: "Explorar fora da zona de conforto exige confiança e consentimento mútuo." },
            { options: {a: "Verdadeiro", b: "Falso"}, answer: 'b', feedback: "Não! O atrito aumenta o risco de rasgarem. Use apenas um." }, { options: {a: "Verdadeiro", b: "Falso"}, answer: 'b', feedback: "Não, é apenas para emergências. É menos eficaz e pode desregular hormônios." }
        ];

        // --- Variáveis Globais ---
        const TOTAL_CASES = 5;
        const PUZZLES_PER_CASE = { 1: 3, 2: 3, 3: 3, 4: 3, 5: 2 };
        const INITIAL_TIME = 600;
        let gameState = {};
        let currentPuzzle = {};
        // *** VARIÁVEL GLOBAL DEFINIDA CORRETAMENTE AQUI ***
        let jogoIniciado = false;

        // --- Elementos DOM ---
        const videoContainer = document.getElementById('video-container');
        const introVideo = document.getElementById('intro-video');
        const skipButton = document.getElementById('skip-video');
        const playButton = document.getElementById('play-video');
        const introScreen = document.getElementById('intro-screen');
        const gameBoard = document.getElementById('game-board');
        const victoryScreen = document.getElementById('victory-screen');
        const timerDisplay = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score');
        const progressDisplay = document.getElementById('progress');
        const caseArea = document.getElementById('case-area');
        const waitingMessage = document.getElementById('waiting-message');

        // --- Funções de Áudio ---
        function tocarSom(id) {
            try {
                const audio = document.getElementById(id);
                if (audio) {
                    audio.currentTime = 0;
                    audio.play().catch(e => console.warn(`Som ${id} bloqueado:`, e.message));
                } else { console.error(`Áudio #${id} não encontrado!`); }
            } catch (error) { console.error(`Erro ao tocar som #${id}:`, error); }
        }

        // --- Funções de Controle do Vídeo ---
        function handleVideoEnd() {
            console.log("handleVideoEnd chamada.");
            if (typeof jogoIniciado === 'undefined') { console.error("ERRO GRAVE: jogoIniciado não está definido!"); jogoIniciado = false; }
            if (jogoIniciado) { console.log("Jogo já iniciado, ignorando handleVideoEnd."); return; }
            videoContainer.classList.add('hidden');
            introScreen.classList.remove('hidden');
            introScreen.classList.add('fade-in');
            document.body.style.overflow = 'auto';
            console.log("Vídeo terminado/pulado, mostrando intro do jogo.");
        }

        function tocarVideoIntro() {
            console.log("tocarVideoIntro chamada.");
            introVideo.play().then(() => {
                playButton.style.display = 'none';
                skipButton.style.display = 'block';
                tocarSom('som-click');
            }).catch(error => {
                console.error("Erro ao tocar vídeo:", error);
                handleVideoEnd();
            });
        }

        // --- Funções de Controle do Jogo ---
        function initializeGameState() {
            gameState = { currentCase: 0, completedCases: 0, score: 0, timeLeft: INITIAL_TIME, gameStarted: false, timer: null };
            currentPuzzle = { 1: 1, 2: 1, 3: 1, 4: 1, 5: 1 };
            jogoIniciado = false; // Garante reset
            console.log("Estado do jogo inicializado/resetado.");
        }

        function startGame() {
            console.log("startGame chamada.");
            if (jogoIniciado) { console.warn("Tentativa de iniciar jogo já iniciado."); return; }
            jogoIniciado = true; // Marca como iniciado

            tocarSom('som-click');
            introScreen.classList.add('hidden');
            gameBoard.classList.remove('hidden');
            gameBoard.classList.add('fade-in');

            // gameState já foi inicializado no load/restart
            gameState.gameStarted = true;

            updateUI();
            startTimer();
            unlockRoom(1);
            showWaitingMessage();
            console.log("Jogo iniciado!");

            const musicaFundo = document.getElementById('som-fundo');
            if (musicaFundo) {
                musicaFundo.volume = 0.3;
                musicaFundo.play().catch(error => { console.warn("Música de fundo bloqueada.", error); document.body.addEventListener('click', () => musicaFundo.play(), { once: true }); });
            }
        }

        function startTimer() {
            clearInterval(gameState.timer);
            console.log("Timer iniciado.");
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                updateTimerDisplay();
                if (gameState.timeLeft <= 0) { gameOver(false); }
            }, 1000);
        }

        function updateUI() { updateTimerDisplay(); updateScoreDisplay(); updateProgressDisplay(); }
        function updateTimerDisplay() {
             const minutes = Math.floor(gameState.timeLeft / 60); const seconds = gameState.timeLeft % 60;
             timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
             if (gameState.timeLeft <= 60 && !timerDisplay.classList.contains('text-red-500')) { timerDisplay.classList.remove('text-yellow-400'); timerDisplay.classList.add('text-red-500', 'pulse'); }
             else if (gameState.timeLeft > 60 && timerDisplay.classList.contains('text-red-500')) { timerDisplay.classList.remove('text-red-500', 'pulse'); timerDisplay.classList.add('text-yellow-400'); }
        }
        function updateScoreDisplay() { scoreDisplay.textContent = gameState.score; }
        function updateProgressDisplay() { progressDisplay.textContent = `${gameState.completedCases}/${TOTAL_CASES}`; }

        function unlockRoom(roomNumber) {
             if (roomNumber > TOTAL_CASES) return;
            const room = document.getElementById(`room-${roomNumber}`); const status = document.getElementById(`status-${roomNumber}`);
            if (room && status) { room.classList.remove('locked'); status.textContent = '🔓'; status.classList.remove('bg-gray-600'); status.classList.add('bg-green-600'); console.log(`Sala ${roomNumber} desbloqueada.`); }
        }

        function enterRoom(roomNumber) {
            const room = document.getElementById(`room-${roomNumber}`);
            if (!room || room.classList.contains('locked')) return;
            // Verifica se jogoIniciado é true
            if (!jogoIniciado) { console.warn("Jogo não iniciado."); return; }

            console.log(`Entrando na sala ${roomNumber}`);
            tocarSom('som-click');
            gameState.currentCase = roomNumber;

            document.querySelectorAll('.case-content').forEach(el => el.classList.add('hidden'));
            waitingMessage.classList.add('hidden');

            const currentCaseElement = document.getElementById(`case-${roomNumber}`);
            if (currentCaseElement) { currentCaseElement.classList.remove('hidden'); currentCaseElement.classList.add('fade-in'); showCurrentPuzzle(roomNumber); }
            else { console.error(`Elemento do caso ${roomNumber} não encontrado!`); showWaitingMessage(); }
        }

         function showCurrentPuzzle(caseNum) {
            const currentPuzzNum = currentPuzzle[caseNum];
            const totalPuzzlesInCase = PUZZLES_PER_CASE[caseNum];
            console.log(`Mostrando Puzzle ${currentPuzzNum}/${totalPuzzlesInCase} do Caso ${caseNum}`);

            document.querySelectorAll(`#case-${caseNum} .question-block`).forEach(el => el.classList.add('hidden'));
            const successMsgElement = document.querySelector(`#success-${caseNum}`);
            if(successMsgElement) successMsgElement.classList.add('hidden');

            const puzzleToShow = document.querySelector(`#case-${caseNum} .question-block:nth-of-type(${currentPuzzNum})`);

            if (puzzleToShow) {
                puzzleToShow.classList.remove('hidden');
                puzzleToShow.classList.add('fade-in');
                puzzleToShow.querySelectorAll('.answer-btn').forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('bg-green-600', 'bg-red-600', 'shake');
                    btn.classList.add('bg-gray-700');
                    btn.innerHTML = btn.innerHTML.replace(' ✅', '').replace(' ❌', '');
                });
                 const oldFeedback = puzzleToShow.querySelector('.feedback-text');
                 if(oldFeedback) oldFeedback.remove();
            } else if (currentPuzzNum > totalPuzzlesInCase) {
                 console.log(`Puzzles do caso ${caseNum} concluídos, mostrando sucesso.`);
                 if (successMsgElement) {
                    const buttonInSuccess = successMsgElement.querySelector('button');
                    if(buttonInSuccess){
                        buttonInSuccess.className = '';
                        buttonInSuccess.classList.add('px-6', 'py-3', 'rounded-lg', 'font-bold', 'mt-4');
                         if(caseNum === TOTAL_CASES) { buttonInSuccess.classList.add('bg-yellow-600', 'hover:bg-yellow-700', 'finish-button'); }
                         else { buttonInSuccess.classList.add('bg-green-600', 'hover:bg-green-700', 'next-button'); }
                    }
                    successMsgElement.classList.remove('hidden');
                    successMsgElement.classList.add('bg-green-900', 'bg-opacity-50', 'rounded-xl', 'p-6', 'border', 'border-green-500', 'text-center', 'fade-in');
                 } else { console.error(`Mensagem de sucesso ${caseNum} não encontrada!`); }
            } else { console.error(`Puzzle ${currentPuzzNum} do caso ${caseNum} não encontrado!`); }
        }

        function showWaitingMessage() {
             document.querySelectorAll('.case-content').forEach(el => el.classList.add('hidden'));
             waitingMessage.classList.remove('hidden');
             waitingMessage.classList.add('fade-in');
             console.log("Mostrando mensagem de espera.");
        }

        // *** FUNÇÃO checkAnswer CORRIGIDA ***
        function checkAnswer(caseNum, answerChoice, button) {
            tocarSom('som-click');
            const currentPuzzNum = currentPuzzle[caseNum];
            const totalPuzzlesInCase = PUZZLES_PER_CASE[caseNum];

            let questionIndex = 0;
            for(let i = 1; i < caseNum; i++){ questionIndex += PUZZLES_PER_CASE[i]; }
            questionIndex += (currentPuzzNum - 1);

            const questionData = gameQuestions[questionIndex];

            if (!questionData) { console.error(`Dados da pergunta não encontrados para caso ${caseNum}, puzzle ${currentPuzzNum}`); return; }

            const correctAnswerValue = questionData.answer;
            const puzzleBlock = button.closest('.question-block');
            const answerButtons = puzzleBlock.querySelectorAll('.answer-btn');
            answerButtons.forEach(btn => btn.disabled = true);

            const oldFeedback = puzzleBlock.querySelector('.feedback-text');
            if (oldFeedback) oldFeedback.remove();

            if (answerChoice === correctAnswerValue) {
                // Correto
                console.log(`Caso ${caseNum}, Puzzle ${currentPuzzNum}: Correto!`);
                tocarSom('som-correto');
                button.classList.remove('bg-gray-700');
                const colorsHover = ['blue', 'red', 'purple', 'teal', 'yellow'];
                 // Remove o hover específico da sala ANTES de adicionar o verde
                button.classList.remove(`hover:bg-${colorsHover[caseNum-1]}-600`);
                button.classList.add('bg-green-600');
                button.innerHTML += ' ✅';
                gameState.score += 100;

                setTimeout(() => {
                    // Verifica se foi o último puzzle DESTA sala
                    if (currentPuzzNum < totalPuzzlesInCase) {
                        currentPuzzle[caseNum]++;
                        showCurrentPuzzle(caseNum);
                    } else {
                        // Último puzzle da sala concluído, mostra mensagem de sucesso
                        console.log(`Último puzzle do caso ${caseNum} concluído.`);
                        puzzleBlock.classList.add('hidden'); // Esconde o puzzle atual
                        // *** CORREÇÃO: Mostra a div de sucesso DIRETAMENTE ***
                        const successMessage = document.getElementById(`success-${caseNum}`);
                        if(successMessage){
                             const buttonInSuccess = successMessage.querySelector('button');
                             if(buttonInSuccess){
                                buttonInSuccess.className = '';
                                buttonInSuccess.classList.add('px-6', 'py-3', 'rounded-lg', 'font-bold', 'mt-4');
                                if(caseNum === TOTAL_CASES) { buttonInSuccess.classList.add('bg-yellow-600', 'hover:bg-yellow-700', 'finish-button'); }
                                else { buttonInSuccess.classList.add('bg-green-600', 'hover:bg-green-700', 'next-button'); }
                            }
                            successMessage.classList.remove('hidden');
                            successMessage.classList.add('bg-green-900', 'bg-opacity-50', 'rounded-xl', 'p-6', 'border', 'border-green-500', 'text-center', 'fade-in');
                        } else { console.error(`Mensagem de sucesso ${caseNum} não encontrada!`); }
                         // *** FIM DA CORREÇÃO ***
                    }
                    updateScoreDisplay();
                }, 1000);

            } else {
                 // Incorreto
                 console.log(`Caso ${caseNum}, Puzzle ${currentPuzzNum}: Incorreto.`);
                 tocarSom('som-incorreto');
                 button.classList.remove('bg-gray-700');
                 const colorsHover = ['blue', 'red', 'purple', 'teal', 'yellow'];
                 button.classList.remove(`hover:bg-${colorsHover[caseNum-1]}-600`);
                 button.classList.add('bg-red-600', 'shake');
                 button.innerHTML += ' ❌';
                 gameState.score = Math.max(0, gameState.score - 25);

                 const feedbackP = document.createElement('p');
                 feedbackP.textContent = `Explicação: ${questionData.feedback}`;
                 feedbackP.classList.add('text-red-300', 'mt-3', 'text-sm', 'fade-in', 'feedback-text');
                 button.parentElement.insertAdjacentElement('afterend', feedbackP);

                 setTimeout(() => {
                    answerButtons.forEach(btn => {
                        btn.disabled = false;
                        btn.classList.remove('shake', 'bg-red-600', 'bg-green-600');
                         btn.classList.add('bg-gray-700');
                         const colors = ['blue', 'red', 'purple', 'teal', 'yellow'];
                         // Garante que só adiciona UMA classe de hover
                         btn.classList.remove(...colors.map(c => `hover:bg-${c}-600`));
                         btn.classList.add(`hover:bg-${colors[caseNum-1]}-600`);
                        btn.innerHTML = btn.innerHTML.replace(' ✅', '').replace(' ❌', '');
                    });
                    if(feedbackP) feedbackP.remove();
                 }, 3000);
                 updateScoreDisplay();
            }
        }

        function completeCase(caseNum) {
            console.log(`completeCase(${caseNum}) chamada.`);
            tocarSom('som-correto');
            gameState.completedCases++;
            updateProgressDisplay();

            const status = document.getElementById(`status-${caseNum}`);
            const room = document.getElementById(`room-${caseNum}`);
            if (status && room) {
                status.textContent = '✅';
                status.classList.remove('bg-green-600');
                status.classList.add('bg-blue-600');
                room.classList.add('opacity-70');
                room.onclick = null;
                 console.log(`Status e clique da Sala ${caseNum} atualizados.`);
            } else { console.error(`Erro ao encontrar elementos da Sala ${caseNum}.`); }

            if (gameState.completedCases < TOTAL_CASES) {
                 console.log(`Desbloqueando Sala ${caseNum + 1} e mostrando espera.`);
                unlockRoom(caseNum + 1);
                showWaitingMessage();
            } else {
                 console.log("Todas as salas completas. Chamando gameOver(true).");
                gameOver(true);
            }
        }

        function gameOver(isVictory) {
            console.log(`Fim de jogo. Vitória: ${isVictory}`);
            clearInterval(gameState.timer);
            gameState.gameStarted = false;
            jogoIniciado = false;

            if (isVictory) {
                tocarSom('som-vitoria');
                gameBoard.classList.add('hidden');
                victoryScreen.classList.remove('hidden');
                victoryScreen.classList.add('fade-in');

                const timeTaken = INITIAL_TIME - gameState.timeLeft;
                const minutes = Math.floor(timeTaken / 60);
                const seconds = timeTaken % 60;
                const timeBonus = Math.max(0, gameState.timeLeft * 2);
                gameState.score += timeBonus;

                document.getElementById('final-time').textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('final-score').textContent = gameState.score;

            } else {
                tocarSom('som-gameover');
                alert('⏰ Tempo esgotado! Você não conseguiu completar a jornada a tempo. Tente novamente!');
                restartGame();
            }
        }

        function restartGame() {
            console.log("Reiniciando o jogo...");
            tocarSom('som-click');
            clearInterval(gameState.timer);

            victoryScreen.classList.add('hidden');
            gameBoard.classList.add('hidden');
            introScreen.classList.remove('hidden');

            timerDisplay.textContent = `${Math.floor(INITIAL_TIME / 60).toString().padStart(2, '0')}:${(INITIAL_TIME % 60).toString().padStart(2, '0')}`;
            timerDisplay.classList.remove('text-red-500', 'pulse'); timerDisplay.classList.add('text-yellow-400');
            scoreDisplay.textContent = '0'; progressDisplay.textContent = `0/${TOTAL_CASES}`;

            for (let i = 1; i <= TOTAL_CASES; i++) {
                const room = document.getElementById(`room-${i}`); const status = document.getElementById(`status-${i}`);
                if (room && status) {
                    room.classList.remove('opacity-70'); room.onclick = () => enterRoom(i);
                    if (i > 1) { room.classList.add('locked'); status.textContent = '🔒'; status.classList.remove('bg-green-600', 'bg-blue-600'); status.classList.add('bg-gray-600'); }
                    else { room.classList.remove('locked'); status.textContent = '🔒'; status.classList.remove('bg-green-600', 'bg-blue-600'); status.classList.add('bg-gray-600'); }
                }
            }

            document.querySelectorAll('.case-content').forEach(el => el.classList.add('hidden'));
            showWaitingMessage();

             document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.disabled = false; btn.classList.remove('bg-green-600', 'bg-red-600', 'shake'); btn.classList.add('bg-gray-700');
                 const caseNumStr = btn.closest('.case-content')?.id.split('-')[1];
                 if(caseNumStr) {
                    const caseNum = parseInt(caseNumStr); const colors = ['blue', 'red', 'purple', 'teal', 'yellow'];
                    // Remove todas as cores de hover antes de adicionar a correta
                    btn.classList.remove(...colors.map(c => `hover:bg-${c}-600`));
                    if(caseNum >=1 && caseNum <= colors.length) { btn.classList.add(`hover:bg-${colors[caseNum-1]}-600`); }
                 }
                btn.innerHTML = btn.innerHTML.replace(' ✅', '').replace(' ❌', '');
            });
            document.querySelectorAll('.feedback-text').forEach(p => p.remove());
            document.querySelectorAll('[id^="puzzle-2-case-"],[id^="puzzle-3-case-"]').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.success-message').forEach(el => el.classList.add('hidden'));

            initializeGameState(); // Reseta o estado
            console.log("Jogo reiniciado. Pronto para começar.");
        }

        // --- Inicialização ---
        console.log("Adicionando listeners...");
        if (playButton) playButton.addEventListener('click', tocarVideoIntro); else console.error("ERRO CRÍTICO: Botão #play-video não encontrado!");
        if (introVideo) introVideo.addEventListener('ended', handleVideoEnd); else console.error("ERRO CRÍTICO: Vídeo #intro-video não encontrado!");
        if (skipButton) skipButton.addEventListener('click', handleVideoEnd); else console.error("ERRO CRÍTICO: Botão #skip-video não encontrado!");
        const restartBtnVictory = victoryScreen ? victoryScreen.querySelector('button') : null;
        if(restartBtnVictory) restartBtnVictory.addEventListener('click', restartGame); else console.warn("Botão de reiniciar não encontrado na tela de vitória!");
        initializeGameState(); // Inicializa ao carregar
        updateUI();
        console.log("Script carregado e pronto.");

    </script>
</body>
</html>