<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabuleiro Imersivo - Educação Sexual</title>
    <script src="/_sdk/element_sdk.js"></script>
    <style>
        /* [ESTILOS CSS INICIAIS - MANTIDOS] */
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: transparent;
            min-height: 100%;
            color: #333;
            overflow-x: auto;
            position: relative;
        }

        .bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .bubble {
            position: absolute;
            border-radius: 50%;
            opacity: 0.6;
            animation: float 6s ease-in-out infinite;
        }

        .bubble:nth-child(1) {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            left: 10%;
            animation-delay: 0s;
        }

        .bubble:nth-child(2) {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            left: 20%;
            animation-delay: 2s;
        }

        .bubble:nth-child(3) {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #45b7d1, #96c93d);
            left: 35%;
            animation-delay: 4s;
        }

        .bubble:nth-child(4) {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #96ceb4, #feca57);
            left: 50%;
            animation-delay: 0s;
        }

        .bubble:nth-child(5) {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #feca57, #ff9ff3);
            left: 70%;
            animation-delay: 3s;
        }

        .bubble:nth-child(6) {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #ff9ff3, #667eea);
            left: 80%;
            animation-delay: 5s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            50% {
                transform: translateY(-10vh) rotate(180deg);
                opacity: 0.8;
            }
        }

        /* Efeitos Visuais de Áudio */
        .music-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .music-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.3);
        }

        .music-button.playing {
            animation: music-pulse 2s infinite;
        }

        @keyframes music-pulse {
            0%, 100% {
                box-shadow: 0 8px 16px rgba(0,0,0,0.2), 0 0 0 0 rgba(102, 126, 234, 0.7);
            }
            50% {
                box-shadow: 0 8px 16px rgba(0,0,0,0.2), 0 0 0 15px rgba(102, 126, 234, 0);
            }
        }

        .sound-waves {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2000;
        }

        .sound-wave {
            position: absolute;
            border: 3px solid;
            border-radius: 50%;
            animation: sound-wave-expand 1.5s ease-out forwards;
        }

        @keyframes sound-wave-expand {
            0% {
                width: 20px;
                height: 20px;
                opacity: 1;
            }
            100% {
                width: 300px;
                height: 300px;
                opacity: 0;
            }
        }

        .dice-visual-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            z-index: 2500;
            pointer-events: none;
            animation: dice-bounce 1s ease-out forwards;
        }

        @keyframes dice-bounce {
            0% {
                transform: translate(-50%, -50%) scale(0) rotate(0deg);
                opacity: 0;
            }
            20% {
                transform: translate(-50%, -50%) scale(1.3) rotate(90deg);
                opacity: 1;
            }
            40% {
                transform: translate(-50%, -50%) scale(0.8) rotate(180deg);
                opacity: 1;
            }
            60% {
                transform: translate(-50%, -50%) scale(1.1) rotate(270deg);
                opacity: 1;
            }
            80% {
                transform: translate(-50%, -50%) scale(0.9) rotate(360deg);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(0) rotate(450deg);
                opacity: 0;
            }
        }

        .move-trail {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #4299e1, #3182ce, transparent);
            border-radius: 50%;
            animation: move-trail-fade 1s ease-out forwards;
            z-index: 15;
        }

        @keyframes move-trail-fade {
            0% {
                transform: scale(1);
                opacity: 1;
                box-shadow: 0 0 15px #4299e1;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.7;
                box-shadow: 0 0 25px #4299e1;
            }
            100% {
                transform: scale(0);
                opacity: 0;
                box-shadow: 0 0 5px #4299e1;
            }
        }

        .coin-visual-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5rem;
            z-index: 2600;
            pointer-events: none;
            animation: coin-spin 2s ease-out forwards;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.9);
        }

        @keyframes coin-spin {
            0% {
                transform: translate(-50%, -50%) scale(0) rotateY(0deg);
                opacity: 0;
            }
            15% {
                transform: translate(-50%, -50%) scale(1.5) rotateY(180deg);
                opacity: 1;
            }
            30% {
                transform: translate(-50%, -50%) scale(1) rotateY(360deg);
                opacity: 1;
            }
             45% {
                transform: translate(-50%, -50%) scale(1.3) rotateY(540deg);
                opacity: 1;
            }
            60% {
                transform: translate(-50%, -50%) scale(0.8) rotateY(720deg);
                opacity: 1;
            }
            75% {
                transform: translate(-50%, -50%) scale(1.1) rotateY(900deg);
                opacity: 1;
            }
            90% {
                transform: translate(-50%, -50%) scale(0.9) rotateY(1080deg);
                opacity: 0.7;
            }
            100% {
                transform: translate(-50%, -50%) scale(0) rotateY(1260deg);
                opacity: 0;
            }
        }

        .error-visual-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5rem;
            z-index: 2600;
            pointer-events: none;
            animation: error-shake 1.5s ease-out forwards;
            text-shadow: 0 0 20px rgba(255, 69, 0, 0.9);
        }

        @keyframes error-shake {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            10% {
                transform: translate(-50%, -50%) scale(1.3);
                opacity: 1;
            }
            15% {
                transform: translate(-45%, -50%) scale(1.2);
                opacity: 1;
            }
            25% {
                transform: translate(-55%, -50%) scale(1.1);
                opacity: 1;
            }
            35% {
                transform: translate(-48%, -50%) scale(1.2);
                opacity: 1;
            }
            45% {
                transform: translate(-52%, -50%) scale(1.1);
                opacity: 1;
            }
            55% {
                transform: translate(-49%, -50%) scale(1.15);
                opacity: 1;
            }
            65% {
                transform: translate(-51%, -50%) scale(1.05);
                opacity: 1;
            }
            75% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.8;
            }
            85% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.5;
            }
            100% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
        }

        .victory-visual-effect {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 6rem;
            z-index: 2700;
            pointer-events: none;
            animation: victory-celebration 3s ease-out forwards;
            text-shadow: 0 0 30px rgba(255, 215, 0, 1);
        }

        @keyframes victory-celebration {
            0% {
                transform: translate(-50%, -50%) scale(0) rotate(0deg);
                opacity: 0;
            }
            15% {
                transform: translate(-50%, -50%) scale(1.5) rotate(72deg);
                opacity: 1;
            }
            30% {
                transform: translate(-50%, -50%) scale(1.2) rotate(144deg);
                opacity: 1;
            }
            45% {
                transform: translate(-50%, -50%) scale(1.4) rotate(216deg);
                opacity: 1;
            }
            60% {
                transform: translate(-50%, -50%) scale(1.1) rotate(288deg);
                opacity: 1;
            }
            75% {
                transform: translate(-50%, -50%) scale(1.3) rotate(360deg);
                opacity: 1;
            }
            85% {
                transform: translate(-50%, -50%) scale(1) rotate(432deg);
                opacity: 0.8;
            }
            95% {
                transform: translate(-50%, -50%) scale(0.7) rotate(504deg);
                opacity: 0.4;
            }
            100% {
                transform: translate(-50%, -50%) scale(0) rotate(576deg);
                opacity: 0;
            }
        }

        .roulette-glow {
            animation: roulette-glow-pulse 0.5s ease-in-out;
        }

        @keyframes roulette-glow-pulse {
            0% {
                box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            }
            50% {
                box-shadow: 0 15px 35px rgba(0,0,0,0.2), 0 0 30px rgba(255, 215, 0, 0.8);
            }
            100% {
                box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            }
        }

        .player-move-glow {
            animation: player-move-glow 1s ease-out;
        }

        @keyframes player-move-glow {
            0% {
                box-shadow: 0 3px 6px rgba(0,0,0,0.4);
            }
            50% {
                box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 20px rgba(66, 153, 225, 0.8);
            }
            100% {
                box-shadow: 0 3px 6px rgba(0,0,0,0.4);
            }
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 2.8rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .instructions {
            font-size: 1.2rem;
            color: #4a5568;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .players-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            gap: 20px;
        }

        .player-card {
            flex: 1;
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .player-card.active {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            transform: scale(1.05);
        }

        .player-card.player2 {
            background: linear-gradient(135deg, #e53e3e, #c53030);
        }

        .player-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .player-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 1.1rem;
        }

        .coins {
            color: #ffd700;
        }

        .bombs {
            color: #ff6b6b;
        }

        .board-container {
            position: relative;
            margin: 30px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            overflow: visible;
            min-height: 700px;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 15px;
            background: transparent;
            padding: 40px;
            border-radius: 50%;
            width: 600px;
            height: 600px;
            position: relative;
            justify-content: center;
            align-items: center;
            overflow: visible;
            contain: layout;
        }

        .square {
            width: 80px;
            height: 100px;
            border: 3px solid rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute;
            text-align: center;
            backdrop-filter: blur(8px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
            animation: float-gentle 3s ease-in-out infinite;
            overflow: visible;
            background: white;
        }

        .character-card {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 140px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
            border: 3px solid #4299e1;
            animation: cardAppear 0.5s ease-out;
            pointer-events: none;
        }

        .character-card.show {
            display: flex;
        }

        .character-card.happy {
            border-color: #48bb78;
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
        }

        .character-card.sad {
            border-color: #e53e3e;
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
        }

        @keyframes cardAppear {
            0% {
                transform: translateX(-50%) scale(0) rotate(180deg);
                opacity: 0;
            }
            100% {
                transform: translateX(-50%) scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .character-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            transition: all 0.3s ease;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .character-avatar.has-image {
            font-size: 0;
        }

        .character-avatar.happy {
            background: linear-gradient(135deg, #48bb78, #38a169);
            animation: bounce 0.6s ease-in-out;
        }

        .character-avatar.sad {
            background: linear-gradient(135deg, #e53e3e, #c53030);
            animation: shake 0.6s ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .explosion-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,69,0,0.8) 0%, rgba(255,140,0,0.6) 30%, rgba(255,215,0,0.4) 60%, transparent 100%);
            z-index: 2000;
            display: none;
            animation: explode 1.5s ease-out;
            pointer-events: none;
        }

        @keyframes explode {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            20% {
                transform: scale(0.5);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
            100% {
                transform: scale(3);
                opacity: 0;
            }
        }

        .explosion-particles {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 10px;
            height: 10px;
            pointer-events: none;
            z-index: 2001;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #ff4500;
            border-radius: 50%;
            animation: particle-explosion 1.5s ease-out forwards;
        }

        @keyframes particle-explosion {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translate(var(--end-x, 100px), var(--end-y, 100px)) scale(0);
            }
        }

        .screen-shake {
            animation: screen-shake 0.8s ease-in-out;
        }

        @keyframes screen-shake {
            0%, 100% { transform: translateX(0); }
            10% { transform: translateX(-10px) translateY(-5px); }
            20% { transform: translateX(10px) translateY(5px); }
            30% { transform: translateX(-8px) translateY(-3px); }
            40% { transform: translateX(8px) translateY(3px); }
            50% { transform: translateX(-6px) translateY(-2px); }
            60% { transform: translateX(6px) translateY(2px); }
            70% { transform: translateX(-4px) translateY(-1px); }
            80% { transform: translateX(4px) translateY(1px); }
            90% { transform: translateX(-2px); }
        }

        .stars-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2500;
        }

        .dancing-star {
            position: absolute;
            font-size: 2.5rem;
            animation: star-dance 2.5s ease-in-out forwards;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.9);
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.7));
        }

        @keyframes star-dance {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            15% {
                transform: scale(1.3) rotate(72deg);
                opacity: 1;
            }
            30% {
                transform: scale(0.7) rotate(144deg);
                opacity: 1;
            }
            45% {
                transform: scale(1.1) rotate(216deg);
                opacity: 1;
            }
            60% {
                transform: scale(0.9) rotate(288deg);
                opacity: 1;
            }
            75% {
                transform: scale(1.2) rotate(360deg);
                opacity: 1;
            }
            90% {
                transform: scale(0.8) rotate(432deg);
                opacity: 0.7;
            }
            100% {
                transform: scale(0) rotate(504deg);
                opacity: 0;
            }
        }

        .star-trail {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #ffd700, #ffed4e, transparent);
            border-radius: 50%;
            animation: trail-sparkle 2s ease-out forwards;
        }

        @keyframes trail-sparkle {
            0% {
                transform: scale(1);
                opacity: 1;
                box-shadow: 0 0 10px #ffd700;
            }
            50% {
                transform: scale(1.5);
                opacity: 0.8;
                box-shadow: 0 0 20px #ffd700;
            }
            100% {
                transform: scale(0);
                opacity: 0;
                box-shadow: 0 0 5px #ffd700;
            }
        }

        .flying-comet {
            position: absolute;
            font-size: 2rem;
            animation: comet-flight 3s ease-in-out forwards;
            text-shadow: 0 0 20px rgba(255, 140, 0, 0.9);
            filter: drop-shadow(0 0 10px rgba(255, 69, 0, 0.8));
            z-index: 2600;
        }

        @keyframes comet-flight {
            0% {
                transform: scale(0.5) rotate(0deg);
                opacity: 0;
            }
            10% {
                transform: scale(1) rotate(45deg);
                opacity: 1;
            }
            90% {
                transform: scale(1.2) rotate(405deg);
                opacity: 1;
                left: var(--end-x);
                top: var(--end-y);
            }
            100% {
                transform: scale(0) rotate(450deg);
                opacity: 0;
                left: var(--end-x);
                top: var(--end-y);
            }
        }

        .comet-trail {
            position: absolute;
            width: 3px;
            height: 60px;
            background: linear-gradient(to bottom,
                rgba(255, 140, 0, 0.9) 0%,
                rgba(255, 69, 0, 0.7) 30%,
                rgba(255, 215, 0, 0.5) 60%,
                transparent 100%);
            border-radius: 50px;
            animation: comet-trail-flight 3s ease-in-out forwards;
            transform-origin: center top;
            z-index: 2550;
        }

        @keyframes comet-trail-flight {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                transform: scale(1) rotate(45deg);
                opacity: 0.8;
            }
            90% {
                transform: scale(1.5) rotate(405deg);
                opacity: 0.6;
                left: var(--trail-end-x);
                top: var(--trail-end-y);
            }
            100% {
                transform: scale(0) rotate(450deg);
                opacity: 0;
                left: var(--trail-end-x);
                top: var(--trail-end-y);
            }
        }

        .character-message {
            font-size: 0.8rem;
            font-weight: bold;
            text-align: center;
            color: #4a5568;
            margin-top: 5px;
        }

        .character-message.happy {
            color: #2f855a;
        }

        .character-message.sad {
            color: #c53030;
        }

        .square:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: rgba(255, 215, 0, 0.8);
        }

        .square-character {
            /* Tamanho ajustado para o ícone/imagem */
            width: 60px; 
            height: 60px;
            border-radius: 50%;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem; /* Para emojis Início/Fim */
            background-size: cover; /* Para as imagens de personagem */
            background-position: center;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.2));
        }

        .square-number {
            font-size: 0.8rem;
            font-weight: bold;
            color: #4a5568;
            background: rgba(255, 255, 255, 0.9);
            padding: 2px 6px;
            border-radius: 8px;
            margin-top: 2px;
        }

        @keyframes float-gentle {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-8px);
            }
        }

        .square.normal {
            background: linear-gradient(135deg, #e8f5e8, #c6f6d5);
            border-color: rgba(72, 187, 120, 0.8);
        }

        .square.vf {
            background: linear-gradient(135deg, #fff5e6, #fed7aa);
            border-color: rgba(237, 137, 54, 0.8);
        }

        .square.start {
            background: linear-gradient(135deg, #e6f3ff, #bee3f8);
            border-color: rgba(66, 153, 225, 0.8);
            width: 90px;
            height: 110px;
        }

        .square.finish {
            background: linear-gradient(135deg, #f0e6ff, #e9d8fd);
            border-color: rgba(159, 122, 234, 0.8);
            width: 90px;
            height: 110px;
            animation: pulse-float 2s infinite, float-gentle 3s ease-in-out infinite;
        }

        @keyframes pulse-float {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(159, 122, 234, 0.7);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 0 15px rgba(159, 122, 234, 0);
                transform: scale(1.1);
            }
        }

        .player {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
            top: -10px;
            z-index: 10;
            box-shadow: 0 3px 6px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        .player.player1 {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            right: -10px;
        }

        .player.player2 {
            background: linear-gradient(135deg, #e53e3e, #c53030);
            right: -30px;
        }

        .roulette-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            z-index: 10;
        }

        .roulette {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: conic-gradient(
                #ff6b6b 0deg 60deg,
                #4ecdc4 60deg 120deg,
                #45b7d1 120deg 180deg,
                #96ceb4 180deg 240deg,
                #feca57 240deg 300deg,
                #ff9ff3 300deg 360deg
            );
            border: 8px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
        }

        .roulette:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 24px rgba(0,0,0,0.4);
        }

        .roulette.spinning {
            animation: spin 2s ease-out;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(1800deg); }
        }

        .roulette-center {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: #4a5568;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .roulette-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ffd700;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .turn-indicator {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: bold;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            text-align: center;
            min-width: 200px;
        }

        .game-info {
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #edf2f7, #e2e8f0);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .winner-announcement {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #2d3748;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 20px 0;
            box-shadow: 0 8px 16px rgba(255, 215, 0, 0.3);
            animation: celebration 1s ease-in-out;
        }

        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal h3 {
            color: #4a5568;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .modal p {
            line-height: 1.6;
            margin-bottom: 20px;
            color: #718096;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: #4299e1;
            color: white;
        }

        .btn-primary:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
            transform: translateY(-2px);
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 1px solid #cbd5e0;
        }

        .vf-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn-true {
            background: #48bb78;
            color: white;
        }

        .btn-true:hover {
            background: #38a169;
        }

        .btn-false {
            background: #e53e3e;
            color: white;
        }

        .btn-false:hover {
            background: #c53030;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }

            .game-title {
                font-size: 2rem;
            }

            .board {
                grid-template-columns: repeat(6, 1fr);
                gap: 6px;
                padding: 15px;
            }

            .square {
                font-size: 0.8rem;
                padding: 3px;
            }

            .dice {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
        }
    </style>
    <style>
        /* Estilos específicos do Modal de Vídeo */
        #videoModal .modal-content {
            max-width: 800px;
            width: 90%;
            padding: 0;
            overflow: hidden;
        }
        #videoModal iframe, #videoModal video {
            display: block;
            width: 100%;
            height: 450px;
            background: #000;
        }
        #videoModal .modal-buttons {
            padding: 20px;
        }
        @media (max-width: 768px) {
            #videoModal iframe, #videoModal video {
                height: 300px;
            }
        }
    </style>
    <style>@view-transition { navigation: auto; }</style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
</head>
<body>
    <audio id="bgm" src="/assets/bgm.mp3" loop></audio>
    <audio id="audioDice" src="/assets/dice_roll.ogg"></audio>
    <audio id="audioCoin" src="/assets/coin.wav"></audio>
    <audio id="audioError" src="/assets/error.mp3"></audio>
    <audio id="audioWin" src="/assets/win.wav"></audio>

    <div class="bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div><div class="explosion-overlay" id="explosionOverlay"></div>
    <div class="explosion-particles" id="explosionParticles"></div><div class="stars-celebration" id="starsCelebration"></div><div class="sound-waves" id="soundWaves"></div><button class="music-button" id="musicButton" onclick="toggleMusic()">🎶 Ligar Música</button>

    <div class="modal" id="videoModal" style="display: flex;">
        <div class="modal-content">
            <h3 id="videoModalTitle" style="padding: 20px 20px 0;">Bem-vindo(a) ao Jogo da Saúde Sexual!</h3>
            <video id="introVideo" width="100%" height="450" controls autoplay>
                <source src="/assets/video/1000007047.mp4" type="video/mp4">
                Seu navegador não suporta a tag de vídeo.
            </video>
            <div class="modal-buttons" style="padding: 20px;">
                <button class="btn btn-primary" onclick="closeVideoModal()">Começar o Jogo</button>
            </div>
        </div>
    </div>

    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title" id="gameTitle">Tabuleiro Imersivo - Educação Sexual</h1>
            <p class="instructions" id="instructionsText">Clique na roleta para jogar! Respostas certas ganham moedas, erradas ganham bombas!</p>
        </div>
        <div class="players-info">
            <div class="player-card player1 active" id="player1Card">
                <div class="player-name" id="player1Name">
                    Jogador 1
                </div>
                <div>
                    Posição: <span id="player1Position">1</span>/40
                </div>
                <div class="player-stats">
                    <div class="stat coins">
                        🪙 <span id="player1Coins">0</span>
                    </div>
                    <div class="stat bombs">
                        💣 <span id="player1Bombs">0</span>
                    </div>
                </div>
            </div>
            <div class="player-card player2" id="player2Card">
                <div class="player-name" id="player2Name">
                    Jogador 2
                </div>
                <div>
                    Posição: <span id="player2Position">1</span>/40
                </div>
                <div class="player-stats">
                    <div class="stat coins">
                        🪙 <span id="player2Coins">0</span>
                    </div>
                    <div class="stat bombs">
                        💣 <span id="player2Bombs">0</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="game-info">
            <div class="turn-indicator" id="turnIndicator">
                Vez do Jogador 1
            </div>
        </div>
        <div class="board-container">
            <div class="board" id="gameBoard"></div>
            <div class="roulette-container">
                <div class="roulette" id="roulette" onclick="spinRoulette()">
                    <div class="roulette-pointer"></div>
                    <div class="roulette-center" id="rouletteResult">
                        🎯
                    </div>
                </div>
                <div style="text-align: center; color: #4a5568; font-weight: bold;">
                    🎲 Clique para rolar o dado!
                </div>
            </div>
        </div>
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #4299e1, #3182ce);"></div><span>Início</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #48bb78, #38a169);"></div><span>Verdadeiro/Falso</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #ed8936, #dd6b20);"></div><span>Verdadeiro/Falso Especial</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #9f7aea, #805ad5);"></div><span>Fim</span>
            </div>
        </div>
    </div><div class="modal" id="questionModal">
        <div class="modal-content">
            <h3 id="modalTitle">Pergunta</h3>
            <p id="modalQuestion"></p>
            <div id="modalButtons" class="modal-buttons"><button class="btn btn-primary" onclick="showAnswer()">Ver Resposta</button>
            </div>
        </div>
    </div><div class="modal" id="answerModal">
        <div class="modal-content">
            <h3 id="answerTitle">Resposta</h3>
            <p id="answerText"></p>
            <div class="modal-buttons"><button class="btn btn-primary" onclick="closeModal()">Continuar</button>
            </div>
        </div>
    </div>
    
    <script src="src/js/dadosDoJogo.js"></script> 
    
    <script>
        // Elementos de áudio e vídeo
        const bgm = document.getElementById('bgm');
        const introVideo = document.getElementById('introVideo');
        const audioDice = document.getElementById('audioDice');
        const audioCoin = document.getElementById('audioCoin');
        const audioError = document.getElementById('audioError');
        const audioWin = document.getElementById('audioWin');

        // Mapeamento das imagens de personagem (CORRIGIDO com caminhos absolutos)
        const characterImages = {
            // Caminhos ajustados para refletir a pasta 'assets' na raiz
            'boy_q': '/assets/img/20251020_222253_0000.png.jpg', 
            'boy_a': '/assets/img/20251020_222254_0003.png.jpg', 
            'boy_e': '/assets/img/20251020_222253_0000.png.jpg',

            'girl_q': '/assets/img/20251020_222254_0002.png.jpg', 
            'girl_a': '/assets/img/20251020_222254_0003.png.jpg', 
            'girl_e': '/assets/img/20251020_222253_0000.png.jpg',
            'girl_d': '/assets/img/20251020_222254_0002.png.jpg'
        };
        
        // Novo mapeamento simplificado para a casa (usa as imagens que você forneceu):
        const imagePergunta = characterImages.girl_q;
        const imageAcerto = characterImages.girl_a;
        const imageErro = characterImages.boy_q;


        // Estado do jogo
        let gameState = {
            currentPlayer: 1,
            players: {
                1: { position: 1, coins: 0, bombs: 0 },
                2: { position: 1, coins: 0, bombs: 0 }
            },
            gameEnded: false,
            musicPlaying: false
        };
        let currentQuestion = null;
        let currentQuestionType = null;

        // Configuração padrão
        const defaultConfig = {
            game_title: "Tabuleiro Imersivo - Educação Sexual",
            player1_name: "Jogador 1",
            player2_name: "Jogador 2",
            instructions_text: "Clique na roleta para jogar! Respostas certas ganham moedas, erradas ganham bombas!"
        };

        // Funções de Áudio
        function playSound(audioElement) {
            if (audioElement) {
                audioElement.currentTime = 0; // Reinicia o áudio
                audioElement.play().catch(e => console.error("Erro ao tentar tocar áudio:", e));
            }
        }

        function toggleMusic() {
            const button = document.getElementById('musicButton');
            gameState.musicPlaying = !gameState.musicPlaying;

            if (gameState.musicPlaying) {
                button.textContent = '🎵 Música Ligada';
                button.classList.add('playing');
                bgm.play().catch(e => console.error("Erro ao tocar BGM:", e));
                createSoundWaves(button, '#667eea', 3);
            } else {
                button.textContent = '🎶 Ligar Música';
                button.classList.remove('playing');
                bgm.pause();
            }
        }

        // Fechar o modal de vídeo (inicia o jogo)
        function closeVideoModal() {
            document.getElementById('videoModal').style.display = 'none';
            introVideo.pause();
            introVideo.currentTime = 0; // Reinicia o vídeo

            // Inicia a música de fundo automaticamente, se não estiver tocando
            if (!gameState.musicPlaying) {
                 toggleMusic();
            }
        }

        function createSoundWaves(element, color, count = 1) {
             const container = document.getElementById('soundWaves');
             const rect = element.getBoundingClientRect();
             const centerX = rect.left + rect.width / 2;
             const centerY = rect.top + rect.height / 2;

             for (let i = 0; i < count; i++) {
                 const wave = document.createElement('div');
                 wave.className = 'sound-wave';
                 wave.style.borderColor = color;
                 wave.style.left = (centerX - 10) + 'px';
                 wave.style.top = (centerY - 10) + 'px';
                 wave.style.animationDelay = (i * 0.3) + 's';

                 container.appendChild(wave);

                 setTimeout(() => {
                     if (container.contains(wave)) {
                         container.removeChild(wave);
                     }
                 }, 1500 + (i * 300));
             }
        }

        function createDiceVisualEffect() {
            // Efeito de som do dado
            playSound(audioDice);
            const effect = document.createElement('div');
            effect.className = 'dice-visual-effect';
            effect.textContent = '🎲';
            document.body.appendChild(effect);

            setTimeout(() => {
                if (document.body.contains(effect)) {
                    document.body.removeChild(effect);
                }
            }, 1000);
        }

        function createMoveTrail(fromElement, toElement) {
             const fromRect = fromElement.getBoundingClientRect();
             const toRect = toElement.getBoundingClientRect();

             const steps = 8;
             for (let i = 0; i < steps; i++) {
                 setTimeout(() => {
                     const trail = document.createElement('div');
                     trail.className = 'move-trail';

                     const progress = i / (steps - 1);
                     const x = fromRect.left + (toRect.left - fromRect.left) * progress;
                     const y = fromRect.top + (toRect.top - fromRect.top) * progress;

                     trail.style.left = x + 'px';
                     trail.style.top = y + 'px';

                     document.body.appendChild(trail);

                     setTimeout(() => {
                         if (document.body.contains(trail)) {
                             document.body.removeChild(trail);
                         }
                     }, 1000);
                 }, i * 100);
             }
        }

        function createCoinVisualEffect() {
            // Efeito de som de moeda
            playSound(audioCoin);
            const effect = document.createElement('div');
            effect.className = 'coin-visual-effect';
            effect.textContent = '🪙';
            document.body.appendChild(effect);

            setTimeout(() => {
                if (document.body.contains(effect)) {
                    document.body.removeChild(effect);
                }
            }, 2000);
        }

        function createErrorVisualEffect() {
            // Efeito de som de erro/bomba
            playSound(audioError);
            const effect = document.createElement('div');
            effect.className = 'error-visual-effect';
            effect.textContent = '💥';
            document.body.appendChild(effect);

            setTimeout(() => {
                if (document.body.contains(effect)) {
                    document.body.removeChild(effect);
                }
            }, 1500);
        }

        function createVictoryVisualEffect() {
            // Efeito de som de vitória
            playSound(audioWin);
            const effect = document.createElement('div');
            effect.className = 'victory-visual-effect';
            effect.textContent = '🏆';
            document.body.appendChild(effect);

            setTimeout(() => {
                if (document.body.contains(effect)) {
                    document.body.removeChild(effect);
                }
            }, 3000);
        }

        // Inicializar o tabuleiro
        function initializeBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';

            const radius = 250; // Raio do círculo
            const centerX = 300; // Centro X do tabuleiro
            const centerY = 300; // Centro Y do tabuleiro

            for (let i = 1; i <= 40; i++) {
                const square = document.createElement('div');
                square.className = 'square';
                square.id = `square-${i}`;

                // Calcular posição em círculo
                const angle = ((i - 1) / 40) * 2 * Math.PI - Math.PI / 2; // Começar no topo
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);

                square.style.left = `${x - 40}px`; // Ajustar para nova largura
                square.style.top = `${y - 50}px`; // Ajustar para nova altura
                square.style.animationDelay = `${i * 0.1}s`; // Delay escalonado para animação

                // 🌟 LÓGICA DE CRIAÇÃO DO ÍCONE/IMAGEM (CORRIGIDA E SIMPLIFICADA) 🌟
                let charImage = '';
                let charLabel = i;
                let charEmoji = ''; 
                
                if (i === 1) {
                    square.classList.add('start');
                    charEmoji = '🚀';
                    charLabel = 'INÍCIO';
                } else if (i === 40) {
                    square.classList.add('finish');
                    charEmoji = '🏆';
                    charLabel = 'FIM';
                } else if (i % 5 === 0 || i % 7 === 0) {
                    square.classList.add('vf');
                    // Casas de V/F usam a imagem padrão (Garota Ideia)
                    charImage = imagePergunta;
                    charLabel = 'V/F';
                } else {
                    square.classList.add('normal');
                    // Casas normais usam a imagem padrão (Garota Ideia)
                    charImage = imagePergunta;
                    charLabel = i;
                }
                
                const character = document.createElement('div');
                character.className = 'square-character';

                if (charImage) {
                    // Se houver imagem (casas normais ou V/F), usa a imagem como background
                    character.style.backgroundImage = `url(${charImage})`;
                    character.textContent = ''; // Garante que não há emoji de fallback
                } else {
                    // Se não houver imagem (Início/Fim), usa o emoji
                    character.textContent = charEmoji;
                }

                const label = document.createElement('div');
                label.className = 'square-number';
                label.textContent = charLabel;
                square.appendChild(character);
                square.appendChild(label);
                // 🌟 FIM DA LÓGICA DE CRIAÇÃO DO ÍCONE/IMAGEM 🌟


                // Adicionar card de reação para casas com perguntas
                if (i !== 1 && i !== 40) {
                    const characterCard = document.createElement('div');
                    characterCard.className = 'character-card';
                    characterCard.id = `character-${i}`;

                    const avatar = document.createElement('div');
                    avatar.className = 'character-avatar';

                    // O avatar inicial usa a imagem padrão
                    avatar.style.backgroundImage = `url(${imagePergunta})`;
                    avatar.classList.add('has-image');
                    avatar.textContent = '';

                    const message = document.createElement('div');
                    message.className = 'character-message';
                    message.textContent = 'Boa sorte!';

                    characterCard.appendChild(avatar);
                    characterCard.appendChild(message);
                    square.appendChild(characterCard);
                }

                // Adicionar jogadores nas posições iniciais
                if (i === 1) {
                    const player1 = document.createElement('div');
                    player1.className = 'player player1';
                    player1.textContent = '1';
                    square.appendChild(player1);

                    const player2 = document.createElement('div');
                    player2.className = 'player player2';
                    player2.textContent = '2';
                    square.appendChild(player2);
                }

                board.appendChild(square);
            }
        }

        function spinRoulette() {
            if (gameState.gameEnded) return;

            const roulette = document.getElementById('roulette');
            const result = document.getElementById('rouletteResult');

            // Efeito visual e sonoro de dado
            createDiceVisualEffect();
            createSoundWaves(roulette, '#ffd700', 2);

            roulette.classList.add('spinning', 'roulette-glow');

            setTimeout(() => {
                const roll = Math.floor(Math.random() * 6) + 1;
                result.textContent = roll;
                roulette.classList.remove('spinning', 'roulette-glow');

                movePlayer(roll);
            }, 2000);
        }

        function movePlayer(steps) {
            const player = gameState.players[gameState.currentPlayer];
            const oldPosition = player.position;

            // Remover jogador da posição atual
            const currentSquare = document.getElementById(`square-${oldPosition}`);
            const playerElement = currentSquare.querySelector(`.player.player${gameState.currentPlayer}`);

            // Calcular nova posição
            player.position = Math.min(player.position + steps, 40);
            const newSquare = document.getElementById(`square-${player.position}`);

            // Criar rastro de movimento
            if (playerElement) {
                createMoveTrail(currentSquare, newSquare);
                playerElement.remove();
            }

            // Adicionar jogador na nova posição com animação suave
            const newPlayer = document.createElement('div');
            newPlayer.className = `player player${gameState.currentPlayer} player-move-glow`;
            newPlayer.textContent = gameState.currentPlayer;
            newPlayer.style.transform = 'scale(0)';
            newSquare.appendChild(newPlayer);

            // Animar entrada do jogador
            setTimeout(() => {
                newPlayer.style.transform = 'scale(1)';
                newPlayer.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            }, 100);

            // Atualizar informações do jogador
            updatePlayerDisplay();

            // Verificar se chegou ao fim
            if (player.position === 40) {
                gameState.gameEnded = true;
                const playerName = gameState.currentPlayer === 1 ?
                    (document.getElementById('player1Name').textContent || 'Jogador 1') :
                    (document.getElementById('player2Name').textContent || 'Jogador 2');

                setTimeout(() => {
                    createVictoryVisualEffect();
                    showWinner(playerName);
                }, 500);
                return;
            }

            // Mostrar pergunta baseada no tipo de casa
            setTimeout(() => {
                const square = document.getElementById(`square-${player.position}`);
                if (square.classList.contains('vf')) {
                    showCharacterCard(player.position);
                    // O array perguntasRisco (casas V/F de alto risco) é usado aqui
                    showVFQuestion(); 
                } else if (square.classList.contains('normal')) {
                    showCharacterCard(player.position);
                    // O array perguntasInformativas (casas normais) é usado aqui
                    showInformativeQuestion(); 
                }
            }, 500);
        }

        function updatePlayerDisplay() {
            const player1 = gameState.players[1];
            const player2 = gameState.players[2];

            document.getElementById('player1Position').textContent = player1.position;
            document.getElementById('player1Coins').textContent = player1.coins;
            document.getElementById('player1Bombs').textContent = player1.bombs;

            document.getElementById('player2Position').textContent = player2.position;
            document.getElementById('player2Coins').textContent = player2.coins;
            document.getElementById('player2Bombs').textContent = player2.bombs;

            // Atualizar indicador de turno
            const player1Card = document.getElementById('player1Card');
            const player2Card = document.getElementById('player2Card');
            const turnIndicator = document.getElementById('turnIndicator');

            if (gameState.currentPlayer === 1) {
                player1Card.classList.add('active');
                player2Card.classList.remove('active');
                turnIndicator.textContent = `Vez do ${document.getElementById('player1Name').textContent || 'Jogador 1'}`;
            } else {
                player1Card.classList.remove('active');
                player2Card.classList.add('active');
                turnIndicator.textContent = `Vez do ${document.getElementById('player2Name').textContent || 'Jogador 2'}`;
            }
        }

        function switchPlayer() {
            gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
            updatePlayerDisplay();
        }

        function showWinner(playerName) {
            const winnerDiv = document.createElement('div');
            winnerDiv.className = 'winner-announcement';
            winnerDiv.innerHTML = `🎉 ${playerName} VENCEU! 🎉<br>Parabéns por completar o tabuleiro de educação sexual!`;

            const gameInfo = document.querySelector('.game-info');
            gameInfo.appendChild(winnerDiv);

            setTimeout(() => {
                showCustomModal('🏆 Fim de Jogo!', `${playerName} chegou primeiro ao final! Parabéns por aprender sobre educação sexual de forma divertida!`, [
                    {text: 'Jogar Novamente', action: () => {
                        gameState = {
                            currentPlayer: 1,
                            players: {
                                1: { position: 1, coins: 0, bombs: 0 },
                                2: { position: 1, coins: 0, bombs: 0 }
                            },
                            gameEnded: false,
                            musicPlaying: gameState.musicPlaying
                        };
                        initializeBoard();
                        updatePlayerDisplay();
                        winnerDiv.remove();
                        closeModal();
                    }}
                ]);
            }, 2000);
        }

        function showInformativeQuestion() {
            // Acesso ao array perguntasInformativas que vem de dadosDoJogo.js
            // Certifique-se de que o arquivo dadosDoJogo.js foi carregado com sucesso
            if (typeof perguntasInformativas === 'undefined') {
                 console.error("Erro: O array 'perguntasInformativas' não foi carregado.");
                 closeModal();
                 return;
            }
            
            const randomIndex = Math.floor(Math.random() * perguntasInformativas.length);
            currentQuestion = perguntasInformativas[randomIndex];
            currentQuestionType = 'informative';

            document.getElementById('modalTitle').textContent = 'Pergunta Informativa';
            document.getElementById('modalQuestion').textContent = currentQuestion.pergunta;
            document.getElementById('modalButtons').innerHTML = `
                <div class="vf-buttons">
                    <button class="btn btn-true" onclick="checkVFAnswer('V')">Verdadeiro</button>
                    <button class="btn btn-false" onclick="checkVFAnswer('F')">Falso</button>
                </div>
            `;

            document.getElementById('questionModal').style.display = 'flex';
        }

        function showVFQuestion() {
            // Acesso ao array perguntasRisco que vem de dadosDoJogo.js
            // Certifique-se de que o arquivo dadosDoJogo.js foi carregado com sucesso
            if (typeof perguntasRisco === 'undefined') {
                 console.error("Erro: O array 'perguntasRisco' não foi carregado.");
                 closeModal();
                 return;
            }
            
            const randomIndex = Math.floor(Math.random() * perguntasRisco.length);
            currentQuestion = perguntasRisco[randomIndex];
            currentQuestionType = 'vf';

            document.getElementById('modalTitle').textContent = 'PERGUNTA DE RISCO (V/F)';
            document.getElementById('modalQuestion').textContent = currentQuestion.pergunta;
            document.getElementById('modalButtons').innerHTML = `
                <div class="vf-buttons">
                    <button class="btn btn-true" onclick="checkVFAnswer('V')">Verdadeiro</button>
                    <button class="btn btn-false" onclick="checkVFAnswer('F')">Falso</button>
                </div>
            `;

            document.getElementById('questionModal').style.display = 'flex';
        }

        function showCharacterCard(position) {
            const characterCard = document.getElementById(`character-${position}`);
            if (characterCard) {
                characterCard.classList.add('show');
            }
        }

        function updateCharacterReaction(position, isCorrect) {
            const characterCard = document.getElementById(`character-${position}`);
            if (characterCard) {
                const avatar = characterCard.querySelector('.character-avatar');
                const message = characterCard.querySelector('.character-message');

                // Determinar se é menino ou menina baseado na posição
                const isGirl = position % 2 === 0;
                let imageFile;

                if (isCorrect) {
                    // Usa a imagem de acerto (YES!)
                    imageFile = imageAcerto; 
                    message.textContent = 'Parabéns! 😊';
                    message.classList.add('happy');
                    characterCard.classList.add('happy');
                } else {
                    // Usa a imagem de erro/dúvida
                    imageFile = imageErro; 
                    message.textContent = 'Que pena! 😔';
                    message.classList.add('sad');
                    characterCard.classList.add('sad');
                }

                // Aplicar imagem de reação
                avatar.style.backgroundImage = `url(${imageFile})`;
                avatar.classList.add('has-image');
                avatar.textContent = '';

                // Mostrar reação e manter visível
                characterCard.classList.add('show');

                // Resetar para estado neutro após 5 segundos, mas manter visível
                setTimeout(() => {
                    characterCard.classList.remove('happy', 'sad');
                    message.classList.remove('happy', 'sad');
                    message.textContent = 'Boa sorte!';

                    // Volta para a imagem neutra de pergunta
                    avatar.style.backgroundImage = `url(${imagePergunta})`;
                }, 5000);
            }
        }

        function checkVFAnswer(answer) {
            const isCorrect = answer === currentQuestion.resposta_correta;
            const player = gameState.players[gameState.currentPlayer];

            // Atualizar reação do personagem
            updateCharacterReaction(player.position, isCorrect);

            if (isCorrect) {
                player.coins++;
                document.getElementById('answerTitle').textContent = '✅ Correto! +1 Moeda';

                // Efeitos visuais e sonoros para acerto
                setTimeout(() => {
                    createCoinVisualEffect();
                    createStarsCelebration();
                }, 500);
            } else {
                player.bombs++;
                document.getElementById('answerTitle').textContent = '❌ Incorreto! +1 Bomba';

                // Efeitos visuais e sonoros para erro
                setTimeout(() => {
                    createErrorVisualEffect();
                    createExplosion();
                }, 500);
            }

            document.getElementById('answerText').textContent = currentQuestion.explicacao;
            updatePlayerDisplay();

            document.getElementById('questionModal').style.display = 'none';
            document.getElementById('answerModal').style.display = 'flex';
        }

        function showAnswer() {
            // Esta função não é usada, o botão chama checkVFAnswer() diretamente.
            closeModal();
        }

        function closeModal() {
            document.getElementById('questionModal').style.display = 'none';
            document.getElementById('answerModal').style.display = 'none';

            // Alternar para o próximo jogador após fechar o modal
            if (!gameState.gameEnded) {
                switchPlayer();
            }
        }

        function showCustomModal(title, message, buttons) {
            document.getElementById('answerTitle').textContent = title;
            document.getElementById('answerText').textContent = message;

            const buttonContainer = document.querySelector('#answerModal .modal-buttons');
            buttonContainer.innerHTML = '';

            buttons.forEach(button => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-primary';
                btn.textContent = button.text;
                btn.onclick = button.action;
                buttonContainer.appendChild(btn);
            });

            document.getElementById('answerModal').style.display = 'flex';
        }

        // Configuração do Element SDK
        async function render(config) {
            const gameTitle = config.game_title || defaultConfig.game_title;
            const player1Name = config.player1_name || defaultConfig.player1_name;
            const player2Name = config.player2_name || defaultConfig.player2_name;
            const instructionsText = config.instructions_text || defaultConfig.instructions_text;

            document.getElementById('gameTitle').textContent = gameTitle;
            document.getElementById('player1Name').textContent = player1Name;
            document.getElementById('player2Name').textContent = player2Name;
            document.getElementById('instructionsText').textContent = instructionsText;

            // Atualizar indicador de turno com os novos nomes
            updatePlayerDisplay();
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || '#4299e1',
                        set: (value) => {
                            config.primary_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: {
                    get: () => config.font_family || 'Segoe UI',
                    set: (value) => {
                        config.font_family = value;
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    }
                },
                fontSizeable: {
                    get: () => config.font_size || 16,
                    set: (value) => {
                        config.font_size = value;
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["game_title", config.game_title || defaultConfig.game_title],
                ["player1_name", config.player1_name || defaultConfig.player1_name],
                ["player2_name", config.player2_name || defaultConfig.defaultConfig.player2_name],
                ["instructions_text", config.instructions_text || defaultConfig.instructions_text]
            ]);
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            initializeBoard();
            updatePlayerDisplay();

            // Tenta iniciar o vídeo automaticamente.
            introVideo.play().catch(e => {
                console.log("Auto-play do vídeo bloqueado. O usuário deve clicar em 'Começar o Jogo'.", e);
            });

            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    render,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }
        });
    </script>
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'992b1b96441302fc',t:'MTc2MTE1ODI2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>